<html>

<head>
    <meta charset="utf-8">
    <title>Information Theory</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">


</head>

<body>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM"
        crossorigin="anonymous"></script>
    <script src="https://code.highcharts.com/highcharts.js"></script>


    <div class="container">
        <div class="row align-items-start">
            <div id="leaderboard" class="col-lg-4">
            </div>
            <div class="col-lg-8">
                <div id="graph"></div>
            </div>
        </div>
    </div>


</body>

<script>

    /** Returns table from cols data, data hast to be dict of arrays with
     * the key being the header. It is assumed that all arrays have the same length.
     * @param {dict} data e.g. {'header1': [1, 2, 3], 'header2': [4, 5, 6]}
     */
    function create_table(data) {

        const keys = Object.keys(data);

        const table = document.createElement("table");
        table.classList.add("table", "table-striped");

        // Create table head
        const table_head = document.createElement("thead");
        const tr = document.createElement("tr");
        for (const key of keys) {
            var th = document.createElement("th");
            th.innerHTML = key;
            tr.appendChild(th);
        }
        table_head.appendChild(tr);
        table.appendChild(table_head);

        // Create table body
        const table_body = document.createElement("tbody");
        for (const row in data[keys[0]]) {
            const tr = document.createElement("tr");
            for (const key of keys) {
                var td = document.createElement("td");
                td.innerHTML = data[key][row];
                tr.appendChild(td);
            }
            table_body.appendChild(tr);
        }
        table.appendChild(table_body);
        return table;
    }

    function GaussKDE(xi, x) {
        return (1 / Math.sqrt(2 * Math.PI)) * Math.exp(Math.pow(xi - x, 2) / -2);
    }

    function create_graph() {

        let dataSource = [93, 93, 96, 100, 101, 102, 102];
        let xiData = [];
        let range = 20,
            startPoint = 88;
        for (i = 0; i < range; i++) {
            xiData[i] = startPoint + i;
        }


        let data_plot = [];
        let N = dataSource.length;
        let kernelChart = [];
        let kernel = [];
        let data = [];

        //Create the density estimate
        for (i = 0; i < xiData.length; i++) {
            let temp = 0;
            kernel.push([]);
            kernel[i].push(new Array(dataSource.length));
            for (j = 0; j < dataSource.length; j++) {
                temp = temp + GaussKDE(xiData[i], dataSource[j]);
                kernel[i][j] = GaussKDE(xiData[i], dataSource[j]);
            }
            data.push([xiData[i], (1 / N) * temp]);
        }

        Highcharts.chart("graph", {
            chart: {
                type: "spline",
                animation: true
            },
            title: {
                text: "Mutual Information"
            },
            yAxis: {
                title: { text: null }
            },
            tooltip: {
                valueDecimals: 3
            },
            plotOptions: {
                series: {
                    marker: {
                        enabled: false
                    },
                }
            },
            series: [
                { name: "MI", data: data }
            ]
        })
    }




    async function main() {
        // Create table by loading data via php
        const data = await fetch("get_exp_results.php").then(response => response.json());

        console.log(data);

        const table_data = { "ID": [0, 1, 2, 3, 4, 5, 6], "Mutual Information": [0, 0, 0, 0, 0, 0, 0] }
        document.getElementById("leaderboard").appendChild(create_table(table_data));

        // Create graph
        create_graph();
    }
    document.addEventListener("DOMContentLoaded", main);
</script>


</html>
